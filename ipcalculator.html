<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Subnet Calculator</title>

<style>
body {
    font-family: Arial;
    background: #f2f2f2;
    padding: 30px;
}

.container {
    background: white;
    padding: 20px;
    max-width: 700px;
    margin: auto;
    border-radius: 10px;
    box-shadow: 0px 0px 10px rgba(0,0,0,0.2);
}

input {
    width: 70%;
    padding: 8px;
}

button {
    padding: 8px 15px;
    cursor: pointer;
}

.result {
    margin-top: 15px;
    white-space: pre-wrap;
    background: #eee;
    padding: 15px;
    border-radius: 5px;
}
</style>
</head>

<body>

<div class="container">
<h2>Subnet Calculator</h2>

<input id="ipInput" placeholder="Example: 192.168.1.10/24">
<button onclick="calculate()">Calculate</button>

<div class="result" id="output"></div>
</div>

<script>

function calculate() {

    const input = document.getElementById("ipInput").value.trim();
    const output = document.getElementById("output");

    try {
        const [ip, prefixStr] = input.split("/");
        const prefix = parseInt(prefixStr);

        if (!ip || isNaN(prefix) || prefix < 0 || prefix > 32) {
            throw "Invalid format";
        }

        const ipParts = ip.split(".").map(Number);
        if (ipParts.length !== 4 || ipParts.some(n => n < 0 || n > 255)) {
            throw "Invalid IP";
        }

        const ipInt = toInt(ipParts);
        const maskInt = prefixToMask(prefix);

        const networkInt = ipInt & maskInt;
        const broadcastInt = networkInt | (~maskInt >>> 0);

        const networkIP = toIP(networkInt);
        const broadcastIP = toIP(broadcastInt);
        const subnetMask = toIP(maskInt);

        const addressType = getPacketTracerType(ipInt, networkInt, broadcastInt);
        const visibility = getPublicPrivate(ipParts);
        const validHost = validateHost(ipInt, networkInt, broadcastInt);

        const firstUsable = (prefix < 31) ? toIP(networkInt + 1) : "N/A";
        const lastUsable = (prefix < 31) ? toIP(broadcastInt - 1) : "N/A";

        const bitTable = generateBitTable(prefix);

        output.textContent =
`Network Address:  ${networkIP}
Broadcast Address: ${broadcastIP}
Subnet Mask:       ${subnetMask}

Address Type:      ${addressType}
Scope:             ${visibility}

First Usable IP:   ${firstUsable}
Last Usable IP:    ${lastUsable}

Bit Allocation:
${bitTable}

Host Validation:
${validHost}
`;

    } catch {
        output.textContent = "Invalid input format. Example: 192.168.1.10/24";
    }
}

function toInt(parts) {
    return ((parts[0]<<24)>>>0) + (parts[1]<<16) + (parts[2]<<8) + parts[3];
}

function toIP(int) {
    return [
        (int>>>24)&255,
        (int>>>16)&255,
        (int>>>8)&255,
        int&255
    ].join(".");
}

function prefixToMask(prefix) {
    return prefix === 0 ? 0 : (0xFFFFFFFF << (32 - prefix)) >>> 0;
}

function getPacketTracerType(ip, net, bc) {
    if (ip >= toInt([224,0,0,0]) && ip <= toInt([239,255,255,255])) return "Multicast";
    if (ip === net) return "Network";
    if (ip === bc) return "Broadcast";
    return "Host";
}

function getPublicPrivate(parts) {
    if (parts[0] === 10) return "Private";
    if (parts[0] === 192 && parts[1] === 168) return "Private";
    if (parts[0] === 172 && parts[1] >= 16 && parts[1] <= 31) return "Private";
    return "Public";
}

function validateHost(ip, net, bc) {
    if (ip === net) return "Invalid (Network Address)";
    if (ip === bc) return "Invalid (Broadcast Address)";
    if (ip >= toInt([224,0,0,0]) && ip <= toInt([239,255,255,255])) {
        return "Invalid (Multicast)";
    }
    return "Valid Host";
}

function generateBitTable(prefix) {
    let bits = prefix;
    let result = "";

    for (let i = 1; i <= 4; i++) {
        if (bits >= 8) {
            result += `Octet ${i}: N\n`;
            bits -= 8;
        }
        else if (bits > 0) {
            let row = "n ".repeat(bits) + "h ".repeat(8 - bits);
            result += `Octet ${i}: ${row.trim()}\n`;
            bits = 0;
        }
        else {
            result += `Octet ${i}: H\n`;
        }
    }

    return result;
}

</script>

</body>
</html>
